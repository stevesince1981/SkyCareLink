{% extends "consumer_base.html" %}

{% block title %}MediFly Consumer - Get Your Loved One Home Safely{% endblock %}

{% block head %}
<style>
/* Enhanced Hero Section with Clean Professional Design */
.hero-section {
    background: linear-gradient(135deg, var(--pastel-blue) 0%, var(--pastel-pink) 50%, var(--pastel-blue) 100%);
    padding: 4rem 0;
    margin-top: 0;
    text-align: center;
    color: var(--text-dark);
    position: relative;
    overflow: hidden;
}

.hero-title {
    font-size: 3rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
    text-shadow: 0 2px 4px rgba(255, 255, 255, 0.8);
}

.hero-subtitle {
    font-size: 1.5rem;
    margin-bottom: 3rem;
    color: var(--text-muted);
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
}

.cta-button {
    display: inline-block;
    background: linear-gradient(135deg, #007bff, #0056b3);
    color: white;
    padding: 1rem 2.5rem;
    border-radius: 50px;
    text-decoration: none;
    font-size: 1.25rem;
    font-weight: 600;
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
    transition: all 0.3s ease;
    margin: 1rem;
    border: none;
}

.cta-button:hover {
    background: linear-gradient(135deg, #0056b3, #004085);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 123, 255, 0.4);
}

.toggle-section {
    background: white;
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    margin: 2rem auto;
    max-width: 600px;
}

.toggle-options {
    display: flex;
    justify-content: center;
    gap: 2rem;
    margin-bottom: 1.5rem;
}

.toggle-option {
    position: relative;
}

.toggle-option input[type="radio"] {
    display: none;
}

.toggle-option label {
    display: block;
    padding: 1rem 2rem;
    border: 2px solid var(--border-light);
    border-radius: 25px;
    background: white;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 500;
    text-align: center;
    min-width: 180px;
}

.toggle-option input[type="radio"]:checked + label {
    background: var(--pastel-blue);
    border-color: #007bff;
    color: #007bff;
    transform: scale(1.05);
}

.toggle-option label:hover {
    border-color: #007bff;
    background: rgba(230, 243, 255, 0.5);
}

/* Enhanced Features with Financial Aid and Education */
.features-section {
    padding: 4rem 0;
    background: rgba(255, 255, 255, 0.9);
}

.feature-card {
    background: white;
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    margin-bottom: 2rem;
    transition: transform 0.3s ease;
    height: 100%;
}

.feature-card:hover {
    transform: translateY(-5px);
}

.feature-card h4 {
    color: var(--primary-blue);
    margin-bottom: 1rem;
}

.feature-card .fa {
    font-size: 2.5rem;
    color: var(--accent-pink);
    margin-bottom: 1rem;
}

.crisis-guide-link {
    display: inline-block;
    margin-top: 1rem;
    padding: 0.75rem 1.5rem;
    background: var(--pastel-pink);
    color: #007bff;
    border-radius: 25px;
    text-decoration: none;
    font-weight: 500;
    transition: all 0.3s ease;
}

.crisis-guide-link:hover {
    background: #ffe6f3;
    transform: translateY(-2px);
}

.financial-aid-section {
    background: linear-gradient(135deg, #e6f3ff, #ffe6f3);
    padding: 3rem 0;
    text-align: center;
}

.financial-aid-embed {
    background: white;
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    margin: 2rem auto;
    max-width: 600px;
}

.trust-indicators {
    background: var(--background-light);
    padding: 3rem 0;
    text-align: center;
}

.trust-badge {
    display: inline-block;
    margin: 0.5rem 1rem;
    padding: 0.75rem 1.5rem;
    background: white;
    border-radius: 25px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    font-weight: 500;
    color: var(--text-dark);
}

/* Enhanced Chatbot Widget */
.chatbot-widget {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #007bff, #0056b3);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.4);
    z-index: 1000;
    transition: all 0.3s ease;
}

.chatbot-widget:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 20px rgba(0, 123, 255, 0.6);
}

.chatbot-widget i {
    color: white;
    font-size: 1.5rem;
}

.chatbot-pulse {
    position: absolute;
    top: -5px;
    right: -5px;
    width: 15px;
    height: 15px;
    background: #28a745;
    border-radius: 50%;
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.2); opacity: 0.7; }
    100% { transform: scale(1); opacity: 1; }
}

/* Security & Compliance Indicators */
.security-banner {
    background: #f8f9fa;
    padding: 1rem;
    text-align: center;
    border-bottom: 1px solid #dee2e6;
    font-size: 0.9rem;
    color: #6c757d;
}

.security-icon {
    color: #28a745;
    margin-right: 0.5rem;
}

@media (max-width: 768px) {
    .hero-title {
        font-size: 2.5rem;
    }
    
    .hero-subtitle {
        font-size: 1.25rem;
    }
    
    .toggle-options {
        flex-direction: column;
        align-items: center;
    }
    
    .chatbot-widget {
        width: 50px;
        height: 50px;
        bottom: 15px;
        right: 15px;
    }
}
</style>
{% endblock %}

{% block content %}
<!-- Security Banner -->
<div class="security-banner">
    <i class="fas fa-shield-alt security-icon"></i>
    HIPAA-compliant transient data handling • No permanent storage • Secure encrypted transport
</div>

<div class="container">
    <!-- Hero Section -->
    <div class="hero-section text-center py-5">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <h1 class="hero-title mb-4">
                    <i class="fas fa-heart text-primary me-3"></i>
                    MediFly: Get Your Loved One Home Safely
                </h1>
                <p class="hero-subtitle mb-4">
                    Compassionate medical transport services when your family needs it most. 
                    We're here to bring them home with care and dignity.
                </p>
                
                <!-- Enhanced Toggle Switch -->
                <div class="toggle-section">
                    <div class="toggle-container">
                        <span class="toggle-label mb-3 d-block">I am a:</span>
                        <div class="toggle-options">
                            <div class="toggle-option">
                                <input type="radio" id="family" name="userType" value="family" checked>
                                <label for="family">
                                    <i class="fas fa-users me-2"></i>
                                    Family/Individual
                                </label>
                            </div>
                            
                            <div class="toggle-option">
                                <input type="radio" id="hospital" name="userType" value="hospital">
                                <label for="hospital">
                                    <i class="fas fa-hospital me-2"></i>
                                    Hospital/Provider
                                </label>
                            </div>
                        </div>
                        <div class="toggle-description mt-3">
                            <small class="text-muted" id="toggle-description">
                                Personal medical transport for your loved one
                            </small>
                        </div>
                    </div>
                </div>
                
                <!-- Main CTA Button -->
                <div class="cta-section">
                    <a href="{{ url_for('intake') }}" class="btn btn-primary btn-lg cta-button" id="main-cta">
                        <i class="fas fa-plane-departure me-2"></i>
                        Find a Medical Flight
                    </a>
                    <p class="cta-subtitle mt-3 text-muted">
                        <i class="fas fa-shield-alt me-1"></i>
                        Secure • Private • AI-powered estimates
                    </p>
                </div>

                <!-- Crisis Guide Link -->
                <div class="mt-4">
                    <a href="#crisis-guide" class="crisis-guide-link" onclick="showCrisisGuide()">
                        <i class="fas fa-book-medical me-2"></i>
                        Crisis Guide: What to Expect in Medical Transport
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Features Section -->
    <div class="features-section py-5">
        <div class="row g-4">
            <div class="col-md-4">
                <div class="feature-card text-center h-100">
                    <i class="fas fa-user-md fa-3x text-primary mb-3"></i>
                    <h4>Medical Expertise</h4>
                    <p>Certified medical teams with ICU experience accompany every flight</p>
                    <div class="mt-auto">
                        <small class="text-muted">✓ Doctor on board available</small>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card text-center h-100">
                    <i class="fas fa-leaf fa-3x text-success mb-3"></i>
                    <h4>Green Routing</h4>
                    <p>Eco-friendly flight paths with carbon offset options available</p>
                    <div class="mt-auto">
                        <small class="text-muted">✓ 5% discount for green routes</small>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="feature-card text-center h-100">
                    <i class="fas fa-robot fa-3x text-info mb-3"></i>
                    <h4>AI Estimates</h4>
                    <p>Instant pricing estimates based on distance, severity, and equipment needs</p>
                    <div class="mt-auto">
                        <small class="text-muted">✓ Compare against provider quotes</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row g-4 mt-2">
            <div class="col-md-6">
                <div class="feature-card text-center h-100">
                    <i class="fas fa-hands-helping fa-3x text-warning mb-3"></i>
                    <h4>Emergency Handoff</h4>
                    <p>Seamless coordination with ground ambulances and destination facilities</p>
                    <div class="mt-auto">
                        <small class="text-muted">✓ RapidSOS integration for EMS alerts</small>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="feature-card text-center h-100">
                    <i class="fas fa-network-wired fa-3x text-secondary mb-3"></i>
                    <h4>Provider Diversity</h4>
                    <p>Access to rural specialists, drones, and hybrid aircraft for comprehensive coverage</p>
                    <div class="mt-auto">
                        <small class="text-muted">✓ 50% rural/emerging tech network</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Financial Aid Section -->
    <div class="financial-aid-section">
        <div class="container">
            <h3 class="mb-4">
                <i class="fas fa-heart me-2"></i>
                Financial Support Available
            </h3>
            <div class="financial-aid-embed">
                <p class="mb-3">We understand medical emergencies can be financially overwhelming.</p>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="p-3 border rounded">
                            <h5><i class="fas fa-donate me-2"></i>GoFundMe Integration</h5>
                            <p class="small mb-2">Set up crowdfunding for medical transport costs</p>
                            <button class="btn btn-outline-primary btn-sm" onclick="showFinancialAid('gofundme')">
                                Learn More
                            </button>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="p-3 border rounded">
                            <h5><i class="fas fa-file-invoice me-2"></i>Insurance Support</h5>
                            <p class="small mb-2">Help with insurance claims and documentation</p>
                            <button class="btn btn-outline-primary btn-sm" onclick="showFinancialAid('insurance')">
                                Learn More
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Patient Journey Timeline -->
    <section class="journey-timeline">
        <div class="container">
            <h2 class="text-center mb-5">Your Family's Journey with MediFly</h2>
            <div class="timeline-step fade-in-up">
                <div class="timeline-icon">
                    <i class="fas fa-phone-alt"></i>
                </div>
                <div class="timeline-content">
                    <h4>Emergency Contact</h4>
                    <p>We receive your request and immediately connect with your family</p>
                    <div class="emotional-support-indicator active"></div>
                </div>
            </div>
            <div class="timeline-step fade-in-up" style="animation-delay: 0.2s">
                <div class="timeline-icon">
                    <i class="fas fa-clipboard-check"></i>
                </div>
                <div class="timeline-content">
                    <h4>Care Assessment</h4>
                    <p>Medical team evaluates your loved one's needs with compassion</p>
                    <div class="emotional-support-indicator active"></div>
                </div>
            </div>
            <div class="timeline-step fade-in-up" style="animation-delay: 0.4s">
                <div class="timeline-icon">
                    <i class="fas fa-helicopter"></i>
                </div>
                <div class="timeline-content">
                    <h4>Safe Transport</h4>
                    <p>Professional medical transport with family updates every step</p>
                    <div class="emotional-support-indicator active"></div>
                </div>
            </div>
            <div class="timeline-step fade-in-up" style="animation-delay: 0.6s">
                <div class="timeline-icon">
                    <i class="fas fa-home"></i>
                </div>
                <div class="timeline-content">
                    <h4>Reunited</h4>
                    <p>Your loved one arrives safely at their destination</p>
                    <div class="emotional-support-indicator active"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Story Examples Section -->
    <section class="storyboard-container">
        <div class="container">
            <h2 class="text-center mb-5">Real Families, Real Stories</h2>
            
            <!-- Story 1: Grandma at Disney -->
            <div class="storyboard-scene active" id="story1">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <div class="scene-illustration">
                            <div class="scene-character disney-castle"></div>
                            <div class="scene-character grandma-character"></div>
                            <div class="scene-character helicopter"></div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h3>Grandma's Disney Emergency</h3>
                        <p class="lead">"During our family vacation at Disney World, Grandma fell and injured her hip. We were 1,200 miles from home and scared."</p>
                        <p>"MediFly got her safely back to her doctor in Minneapolis within 4 hours. The medical team kept us updated every 30 minutes."</p>
                        <small class="text-muted">- Sarah, Grandma's daughter</small>
                        <div class="mt-3">
                            <button class="btn btn-sm btn-outline-primary" onclick="playStory(1)">
                                <i class="fas fa-play"></i> Watch Story
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Story 2: Mountain Rescue -->
            <div class="storyboard-scene" id="story2" style="animation-delay: 1s">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <div class="scene-illustration">
                            <div class="scene-character" style="top: 60px; left: 30px; width: 80px; height: 60px; background: linear-gradient(135deg, #8d6e63, #a1887f); clip-path: polygon(0% 100%, 50% 0%, 100% 100%);"></div>
                            <div class="scene-character" style="bottom: 30px; right: 50px; width: 50px; height: 70px; background: linear-gradient(135deg, #81c784, #a5d6a7); border-radius: 25px 25px 10px 10px;"></div>
                            <div class="helicopter" style="animation-delay: 0.5s;"></div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h3>Mountain Hiking Accident</h3>
                        <p class="lead">"Dad was hiking in Colorado when he had chest pains. The local hospital wanted to transfer him to Denver."</p>
                        <p>"MediFly arranged everything - from mountain rescue to specialized cardiac transport. He's recovering well at home now."</p>
                        <small class="text-muted">- Mike, Son</small>
                        <div class="mt-3">
                            <button class="btn btn-sm btn-outline-primary" onclick="playStory(2)">
                                <i class="fas fa-play"></i> Watch Story
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Story 3: Newborn Transport -->
            <div class="storyboard-scene" id="story3" style="animation-delay: 2s">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <div class="scene-illustration">
                            <div class="scene-character" style="top: 80px; left: 60px; width: 40px; height: 50px; background: linear-gradient(135deg, #ffcdd2, #f8bbd9); border-radius: 20px;"></div>
                            <div class="scene-character" style="bottom: 40px; right: 60px; width: 60px; height: 40px; background: linear-gradient(135deg, #ffffff, #f5f5f5); border-radius: 15px;"></div>
                            <div class="helicopter" style="animation-delay: 1s;"></div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h3>Premature Baby Transport</h3>
                        <p class="lead">"Our baby was born 8 weeks early while we were visiting family. The NICU here couldn't provide the specialized care needed."</p>
                        <p>"MediFly's neonatal team transported our little one safely to Children's Hospital. Professional, caring, and gave us hope."</p>
                        <small class="text-muted">- Jennifer & Mark, Parents</small>
                        <div class="mt-3">
                            <button class="btn btn-sm btn-outline-primary" onclick="playStory(3)">
                                <i class="fas fa-play"></i> Watch Story
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Comfort Soundtrack Generator -->
    <section class="comfort-soundtrack">
        <div class="container">
            <h2 class="text-center mb-4">Comfort During Transport</h2>
            <p class="lead text-center">Choose calming sounds to help reduce anxiety during the journey</p>
            <div class="soundtrack-controls">
                <button class="soundtrack-btn" data-sound="nature" onclick="playComfortSound('nature')">
                    <i class="fas fa-leaf"></i> Nature Sounds
                </button>
                <button class="soundtrack-btn" data-sound="classical" onclick="playComfortSound('classical')">
                    <i class="fas fa-music"></i> Classical Music
                </button>
                <button class="soundtrack-btn" data-sound="meditation" onclick="playComfortSound('meditation')">
                    <i class="fas fa-spa"></i> Meditation
                </button>
                <button class="soundtrack-btn" data-sound="family" onclick="playComfortSound('family')">
                    <i class="fas fa-heart"></i> Family Messages
                </button>
            </div>
            <div id="soundtrack-player" class="mt-4 text-center">
                <p class="text-muted">Select a soundtrack above to preview calming sounds</p>
                <div id="sound-description" class="mt-2"></div>
            </div>
        </div>
    </section>

    <!-- Trust Indicators -->
    <div class="trust-indicators">
        <div class="container">
            <h4 class="mb-4">Trusted by Families Nationwide</h4>
            <div class="row justify-content-center">
                <div class="col-auto">
                    <span class="trust-badge">
                        <i class="fas fa-shield-alt me-2"></i>HIPAA Compliant
                    </span>
                </div>
                <div class="col-auto">
                    <span class="trust-badge">
                        <i class="fas fa-certificate me-2"></i>$1M Insurance
                    </span>
                </div>
                <div class="col-auto">
                    <span class="trust-badge">
                        <i class="fas fa-clock me-2"></i>24/7 Support
                    </span>
                </div>
                <div class="col-auto">
                    <span class="trust-badge">
                        <i class="fas fa-star me-2"></i>98% Family Satisfaction
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Comprehensive Admin Access Section -->
<section class="admin-access" style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 3rem 0; margin-top: 4rem;">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-10">
                <div class="card shadow-lg">
                    <div class="card-header bg-primary text-white text-center">
                        <h3><i class="fas fa-cogs me-2"></i>Comprehensive Admin Features</h3>
                        <p class="mb-0">Full administrative access to all MediFly systems</p>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <!-- Column 1: Core Admin -->
                            <div class="col-md-4 mb-3">
                                <h5 class="text-primary"><i class="fas fa-chart-bar me-2"></i>Analytics & Dashboards</h5>
                                <div class="list-group">
                                    <a href="{{ url_for('dashboard') }}" class="list-group-item list-group-item-action">
                                        <i class="fas fa-tachometer-alt me-2"></i>Business Dashboard
                                        <small class="d-block text-muted">Revenue, profit sharing, real-time analytics</small>
                                    </a>
                                    <a href="{{ url_for('admin_panel') }}" class="list-group-item list-group-item-action">
                                        <i class="fas fa-cog me-2"></i>Admin Panel
                                        <small class="d-block text-muted">Comprehensive co-founder dashboard</small>
                                    </a>
                                </div>
                            </div>
                            
                            <!-- Column 2: Provider Management -->
                            <div class="col-md-4 mb-3">
                                <h5 class="text-success"><i class="fas fa-hospital me-2"></i>Provider Management</h5>
                                <div class="list-group">
                                    <a href="{{ url_for('provider_search') }}" class="list-group-item list-group-item-action">
                                        <i class="fas fa-search me-2"></i>Provider Search
                                        <small class="d-block text-muted">Search bookings, HIPAA-masked data</small>
                                    </a>
                                    <a href="{{ url_for('provider_rewards') }}" class="list-group-item list-group-item-action">
                                        <i class="fas fa-trophy me-2"></i>Provider Rewards
                                        <small class="d-block text-muted">Tier system, leaderboards, payments</small>
                                    </a>
                                </div>
                            </div>
                            
                            <!-- Column 3: Security & Migration -->
                            <div class="col-md-4 mb-3">
                                <h5 class="text-danger"><i class="fas fa-shield-alt me-2"></i>Security & Migration</h5>
                                <div class="list-group">
                                    <a href="{{ url_for('security_scan') }}" class="list-group-item list-group-item-action">
                                        <i class="fas fa-bug me-2"></i>OWASP Security Scan
                                        <small class="d-block text-muted">Vulnerability assessment, HIPAA compliance</small>
                                    </a>
                                    <a href="{{ url_for('migration_status') }}" class="list-group-item list-group-item-action">
                                        <i class="fas fa-rocket me-2"></i>Bubble Migration
                                        <small class="d-block text-muted">10-booking threshold, checklist status</small>
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Feature Highlights -->
                        <div class="row mt-4 pt-4 border-top">
                            <div class="col-md-12">
                                <h6 class="text-muted text-center mb-3">Key Features Available</h6>
                                <div class="row text-center">
                                    <div class="col-md-3">
                                        <div class="feature-highlight">
                                            <i class="fas fa-dollar-sign text-success fs-4"></i>
                                            <small class="d-block">$847,500 Revenue</small>
                                            <small class="text-muted">7 bookings completed</small>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="feature-highlight">
                                            <i class="fas fa-users text-primary fs-4"></i>
                                            <small class="d-block">Provider Rewards</small>
                                            <small class="text-muted">3 tiers, $50K distributed</small>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="feature-highlight">
                                            <i class="fas fa-shield-alt text-warning fs-4"></i>
                                            <small class="d-block">Security Score</small>
                                            <small class="text-muted">94% HIPAA compliance</small>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="feature-highlight">
                                            <i class="fas fa-rocket text-info fs-4"></i>
                                            <small class="d-block">Migration Ready</small>
                                            <small class="text-muted">70% to Bubble threshold</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Emergency Contact Sharing Button -->
<button class="emergency-contact-share pulse-gentle" onclick="showEmergencyShare()">
    <i class="fas fa-phone-alt"></i> Emergency Share
</button>

<!-- Enhanced Chatbot Widget -->
<div class="chatbot-widget" onclick="toggleChatbot()">
    <i class="fas fa-comments"></i>
    <div class="chatbot-pulse"></div>
</div>

<!-- Modals for Education and Financial Aid -->
<div class="modal fade" id="crisisGuideModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-book-medical me-2"></i>
                    Crisis Guide: What to Expect in Medical Transport
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row g-4">
                    <div class="col-md-6">
                        <h6><i class="fas fa-clipboard-list me-2"></i>Before Transport</h6>
                        <ul class="small">
                            <li>Gather medical records and insurance information</li>
                            <li>Pack essential medications (7-day supply)</li>
                            <li>Bring comfortable clothing and personal items</li>
                            <li>Arrange for family transportation to destination</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6><i class="fas fa-plane me-2"></i>During Transport</h6>
                        <ul class="small">
                            <li>Medical team monitors patient continuously</li>
                            <li>Family updates provided every 30 minutes</li>
                            <li>Ground ambulance coordinates for arrival</li>
                            <li>Emergency handoff protocols activated if needed</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('MediFly Consumer application initialized');
    
    // Initialize chatbot
    initializeChatbot();
    
    // Initialize toggle functionality
    const hospitalRadio = document.getElementById('hospital');
    const familyRadio = document.getElementById('family');
    const mainCTA = document.getElementById('main-cta');
    const toggleDescription = document.getElementById('toggle-description');
    
    // Hospital toggle handler - transform interface
    hospitalRadio.addEventListener('change', function() {
        if (this.checked) {
            // Update description and CTA
            toggleDescription.textContent = 'Professional medical transport coordination';
            mainCTA.innerHTML = '<i class="fas fa-building me-2"></i>Hospital Portal Available';
            mainCTA.className = 'btn btn-outline-primary btn-lg cta-button';
            mainCTA.style.cursor = 'not-allowed';
            
            // Transform to hospital styling
            document.querySelector('.hero-title').innerHTML = '<i class="fas fa-hospital me-3"></i>MediFly for Hospitals: Critical Transport Solutions';
            document.querySelector('.hero-subtitle').innerHTML = 'Professional air medical transport coordination for hospital staff. Fast, secure, and compliant with healthcare standards.';
            
            // Show hospital mode message
            const transitionDiv = document.createElement('div');
            transitionDiv.className = 'alert alert-info mt-3';
            transitionDiv.innerHTML = '<i class="fas fa-hospital me-2"></i>Hospital portal interface activated. Full hospital app available at main deployment.';
            toggleDescription.parentNode.appendChild(transitionDiv);
        }
    });
    
    // Family toggle handler - restore family mode
    familyRadio.addEventListener('change', function() {
        if (this.checked) {
            toggleDescription.textContent = 'Personal medical transport for your loved one';
            mainCTA.href = '{{ url_for("intake") }}';
            mainCTA.innerHTML = '<i class="fas fa-plane-departure me-2"></i>Find a Medical Flight';
            mainCTA.className = 'btn btn-primary btn-lg cta-button';
            mainCTA.style.cursor = 'pointer';
            
            // Restore family styling
            document.querySelector('.hero-title').innerHTML = '<i class="fas fa-heart text-primary me-3"></i>MediFly: Get Your Loved One Home Safely';
            document.querySelector('.hero-subtitle').innerHTML = 'Compassionate medical transport services when your family needs it most. We\'re here to bring them home with care and dignity.';
            
            // Remove any transition messages
            const existingAlerts = document.querySelectorAll('.alert');
            existingAlerts.forEach(alert => {
                if (alert.textContent.includes('Hospital portal') || alert.textContent.includes('Redirecting')) {
                    alert.remove();
                }
            });
        }
    });
});

function showCrisisGuide() {
    const modal = new bootstrap.Modal(document.getElementById('crisisGuideModal'));
    modal.show();
}

function showFinancialAid(type) {
    if (type === 'gofundme') {
        alert('GoFundMe Integration: Set up a medical fundraising campaign to help cover transport costs. Our team can help you create compelling campaign messaging and share with your network.');
    } else if (type === 'insurance') {
        alert('Insurance Support: We provide detailed documentation for insurance claims, including medical necessity forms, transport receipts, and provider certifications to maximize your reimbursement.');
    }
}

function toggleChatbot() {
    // Enhanced chatbot with family context
    const messages = [
        {
            trigger: 'welcome',
            message: 'Hello! I\'m here to help you understand our medical transport options for your loved one. How can I assist you today?',
            type: 'text'
        },
        {
            trigger: 'severity',
            message: 'Can you explain the severity levels?',
            type: 'text'
        },
        {
            trigger: 'severity_response', 
            message: 'Severity 1: Minor conditions like fractures. Severity 2-3: Moderate conditions requiring monitoring. Severity 4: Serious conditions needing ICU care. Severity 5: Critical conditions with life support.',
            type: 'text'
        },
        {
            trigger: 'equipment',
            message: 'What medical equipment is available?',
            type: 'text'
        },
        {
            trigger: 'equipment_response',
            message: 'We provide ventilators, ECMO machines, incubators, oxygen support, and medical escorts. Each provider has different equipment capabilities displayed in their profile.',
            type: 'text'
        },
        {
            trigger: 'family_options',
            message: 'What family accommodations are available?',
            type: 'text'
        },
        {
            trigger: 'family_response',
            message: 'We offer Family Seat (+$5,000) for a companion to travel with the patient, and VIP Cabin (+$10,000) with enhanced comfort features and priority medical attention.',
            type: 'text'
        }
    ];
    
    console.log('Initializing family-focused chatbot with messages:', messages);
    alert('💬 Family Support Chat: "I can help explain our services, severity levels, equipment options, and family accommodations. What would you like to know about bringing your loved one home safely?"');
}

function initializeChatbot() {
    console.log('Initializing enhanced family chatbot widget');
}

// Emergency Contact Sharing
function showEmergencyShare() {
    const modal = document.createElement('div');
    modal.className = 'modal fade emergency-share-modal';
    modal.innerHTML = `
        <div class="modal-dialog">
            <div class="emergency-share-content">
                <h4><i class="fas fa-phone-alt me-2"></i>Emergency Contact Share</h4>
                <p>Quickly share patient transport details with emergency contacts:</p>
                <div class="mb-3">
                    <label class="form-label">Emergency Contact Name</label>
                    <input type="text" class="form-control" id="emergency-name" placeholder="Enter contact name">
                </div>
                <div class="mb-3">
                    <label class="form-label">Phone Number</label>
                    <input type="tel" class="form-control" id="emergency-phone" placeholder="Enter phone number">
                </div>
                <div class="mb-3">
                    <label class="form-label">Relationship</label>
                    <select class="form-control" id="emergency-relationship">
                        <option>Spouse</option>
                        <option>Adult Child</option>
                        <option>Parent</option>
                        <option>Sibling</option>
                        <option>Other Family</option>
                        <option>Friend</option>
                    </select>
                </div>
                <div class="d-flex gap-2">
                    <button class="btn btn-primary flex-fill" onclick="sendEmergencyNotification()">
                        <i class="fas fa-paper-plane"></i> Send Update
                    </button>
                    <button class="btn btn-secondary" onclick="closeEmergencyShare()">Cancel</button>
                </div>
            </div>
        </div>
    `;
    document.body.appendChild(modal);
    new bootstrap.Modal(modal).show();
}

function sendEmergencyNotification() {
    const name = document.getElementById('emergency-name').value;
    const phone = document.getElementById('emergency-phone').value;
    const relationship = document.getElementById('emergency-relationship').value;
    
    if (name && phone) {
        alert(`Emergency notification sent to ${name} (${relationship}) at ${phone}. They will receive updates about the medical transport status.`);
        closeEmergencyShare();
    } else {
        alert('Please fill in all required fields.');
    }
}

function closeEmergencyShare() {
    const modal = document.querySelector('.emergency-share-modal');
    if (modal) {
        bootstrap.Modal.getInstance(modal).hide();
        setTimeout(() => modal.remove(), 300);
    }
}

// Storyboard Animation
function playStory(storyNumber) {
    const story = document.getElementById(`story${storyNumber}`);
    const scenes = document.querySelectorAll('.storyboard-scene');
    
    scenes.forEach(scene => scene.classList.remove('active'));
    
    setTimeout(() => {
        story.classList.add('active');
        
        const characters = story.querySelectorAll('.scene-character');
        characters.forEach((char, index) => {
            setTimeout(() => {
                char.style.transform = 'scale(1.1)';
                setTimeout(() => {
                    char.style.transform = 'scale(1)';
                }, 200);
            }, index * 300);
        });
    }, 100);
}

// Comfort Soundtrack Generator
let currentAudio = null;

function playComfortSound(soundType) {
    if (currentAudio) {
        currentAudio.pause();
        currentAudio = null;
    }
    
    document.querySelectorAll('.soundtrack-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    event.target.classList.add('active');
    
    const soundDescriptions = {
        nature: {
            title: 'Nature Sounds',
            description: 'Gentle rain, forest birds, and ocean waves to create a peaceful environment',
            duration: '30 minutes of calming nature audio'
        },
        classical: {
            title: 'Classical Music', 
            description: 'Soft piano and string compositions designed to reduce anxiety',
            duration: 'Peaceful classical selections'
        },
        meditation: {
            title: 'Meditation Sounds',
            description: 'Breathing exercises and mindfulness audio to promote relaxation',
            duration: 'Guided meditation for medical transport'
        },
        family: {
            title: 'Family Messages',
            description: 'Record and play personalized messages from loved ones',
            duration: 'Custom family recordings available'
        }
    };
    
    const sound = soundDescriptions[soundType];
    const player = document.getElementById('soundtrack-player');
    
    player.innerHTML = `
        <div class="p-3 bg-light rounded">
            <h5><i class="fas fa-volume-up me-2"></i>${sound.title}</h5>
            <p class="mb-2">${sound.description}</p>
            <small class="text-muted">${sound.duration}</small>
            <div class="mt-3">
                <button class="btn btn-sm btn-success" onclick="simulateAudioPlay('${soundType}')">
                    <i class="fas fa-play"></i> Preview
                </button>
                <button class="btn btn-sm btn-outline-secondary ms-2" onclick="stopAudio()">
                    <i class="fas fa-stop"></i> Stop
                </button>
            </div>
        </div>
    `;
}

function simulateAudioPlay(soundType) {
    const playButton = event.target;
    playButton.innerHTML = '<i class="fas fa-pause"></i> Playing...';
    playButton.disabled = true;
    
    setTimeout(() => {
        playButton.innerHTML = '<i class="fas fa-play"></i> Preview';
        playButton.disabled = false;
    }, 3000);
    
    const description = document.getElementById('sound-description');
    description.innerHTML = `<div class="alert alert-success"><i class="fas fa-music"></i> Playing ${soundType} sounds for comfort...</div>`;
}

function stopAudio() {
    if (currentAudio) {
        currentAudio.pause();
        currentAudio = null;
    }
    
    document.querySelectorAll('.soundtrack-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    
    const player = document.getElementById('soundtrack-player');
    player.innerHTML = '<p class="text-muted">Select a soundtrack above to preview calming sounds</p>';
    
    const description = document.getElementById('sound-description');
    description.innerHTML = '';
}

// Enhanced Timeline Animations and Auto-Story Rotation
document.addEventListener('DOMContentLoaded', function() {
    const timelineSteps = document.querySelectorAll('.timeline-step');
    
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('fade-in-up');
            }
        });
    });
    
    timelineSteps.forEach(step => {
        observer.observe(step);
    });
    
    // Auto-play storyboard scenes
    let currentStory = 1;
    setInterval(() => {
        playStory(currentStory);
        currentStory = currentStory === 3 ? 1 : currentStory + 1;
    }, 8000);
});
</script>
{% endblock %}