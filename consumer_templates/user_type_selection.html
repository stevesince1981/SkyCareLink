{% extends "consumer_base.html" %}

{% block title %}Join SkyCareLink - Select Your Account Type{% endblock %}

{% block head %}
<style>
.user-type-card {
    transition: all 0.3s ease;
    cursor: pointer;
    min-height: 300px;
}

.user-type-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
}

.user-type-card.selected {
    border: 3px solid #007bff;
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(0,123,255,0.2);
}

.user-type-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
}

.selection-section {
    padding: 3rem 0;
    background: #f8f9fa;
}
</style>
{% endblock %}

{% block content %}
<section class="selection-section">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="text-center mb-5">
                    <h1 class="h2 mb-3">Join SkyCareLink</h1>
                    <p class="lead text-muted">Choose your account type to get started</p>
                </div>

                <div class="row g-4 mb-5">
                    <!-- Affiliate Card -->
                    <div class="col-12 col-md-4">
                        <div class="card user-type-card h-100" onclick="selectUserType('affiliate', this)">
                            <div class="card-body text-center d-flex flex-column">
                                <div class="user-type-icon text-primary">
                                    <i class="fas fa-helicopter"></i>
                                </div>
                                <h4 class="card-title mb-3">Affiliate</h4>
                                <p class="card-text flex-grow-1">Air medical transport providers looking to join our network and receive quote requests from patients and hospitals.</p>
                                <ul class="list-unstyled text-start mt-3">
                                    <li><i class="fas fa-check text-success me-2"></i>Receive qualified leads</li>
                                    <li><i class="fas fa-check text-success me-2"></i>Competitive commission structure</li>
                                    <li><i class="fas fa-check text-success me-2"></i>Professional dashboard</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Provider Card -->
                    <div class="col-12 col-md-4">
                        <div class="card user-type-card h-100" onclick="selectUserType('provider', this)">
                            <div class="card-body text-center d-flex flex-column">
                                <div class="user-type-icon text-success">
                                    <i class="fas fa-hospital"></i>
                                </div>
                                <h4 class="card-title mb-3">Healthcare Provider</h4>
                                <p class="card-text flex-grow-1">Hospitals, clinics, and healthcare facilities needing to arrange medical transport for patients.</p>
                                <ul class="list-unstyled text-start mt-3">
                                    <li><i class="fas fa-check text-success me-2"></i>Quick quote requests</li>
                                    <li><i class="fas fa-check text-success me-2"></i>HIPAA compliant platform</li>
                                    <li><i class="fas fa-check text-success me-2"></i>Multiple provider options</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Individual Card -->
                    <div class="col-12 col-md-4">
                        <div class="card user-type-card h-100" onclick="selectUserType('individual', this)">
                            <div class="card-body text-center d-flex flex-column">
                                <div class="user-type-icon text-warning">
                                    <i class="fas fa-users"></i>
                                </div>
                                <h4 class="card-title mb-3">Individual</h4>
                                <p class="card-text flex-grow-1">Families and individuals who need medical transport services for themselves or loved ones.</p>
                                <ul class="list-unstyled text-start mt-3">
                                    <li><i class="fas fa-check text-success me-2"></i>Compare multiple quotes</li>
                                    <li><i class="fas fa-check text-success me-2"></i>Transparent pricing</li>
                                    <li><i class="fas fa-check text-success me-2"></i>24/7 support</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Registration Forms for Each Type -->
                <div id="registrationForms" style="display: none;">
                    
                    <!-- Affiliate Registration Form -->
                    <div id="affiliateForm" class="registration-form" style="display: none;">
                        <div class="card shadow-sm">
                            <div class="card-header bg-primary text-white">
                                <h4 class="mb-0"><i class="fas fa-helicopter me-2"></i>Transport Affiliate Registration</h4>
                            </div>
                            <div class="card-body">
                                <form method="POST" action="{{ url_for('join_affiliate') }}">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="company_name" class="form-label">Company Name *</label>
                                            <input type="text" class="form-control" id="company_name" name="company_name" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="contact_name" class="form-label">Primary Contact *</label>
                                            <input type="text" class="form-control" id="contact_name" name="contact_name" required>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="email" class="form-label">Business Email *</label>
                                            <input type="email" class="form-control" id="email" name="email" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="phone" class="form-label">Business Phone *</label>
                                            <input type="tel" class="form-control" id="phone" name="phone" required>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="after_hours_phone" class="form-label">24/7 Contact Number</label>
                                            <input type="tel" class="form-control" id="after_hours_phone" name="after_hours_phone">
                                            <div class="form-check mt-2">
                                                <input class="form-check-input" type="checkbox" id="same_as_business_phone" onchange="toggleSamePhone()">
                                                <label class="form-check-label" for="same_as_business_phone">
                                                    Same as business phone
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="coverage_regions" class="form-label">Coverage Regions *</label>
                                            <select class="form-control" id="coverage_regions" name="coverage_regions" required multiple>
                                                <option value="northeast">Northeast (ME, NH, VT, MA, RI, CT, NY, NJ, PA)</option>
                                                <option value="southeast">Southeast (DE, MD, DC, VA, WV, KY, TN, NC, SC, GA, FL, AL, MS)</option>
                                                <option value="midwest">Midwest (OH, IN, IL, MI, WI, MN, IA, MO, ND, SD, NE, KS)</option>
                                                <option value="southwest">Southwest (TX, OK, AR, LA, NM, AZ)</option>
                                                <option value="west">West (CO, WY, MT, ID, UT, NV, CA, OR, WA, AK, HI)</option>
                                                <option value="nationwide">Nationwide Coverage</option>
                                            </select>
                                            <small class="text-muted">Hold Ctrl to select multiple regions</small>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label for="service_area" class="form-label">Service Capabilities</label>
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" name="services[]" value="critical_care" id="critical_care">
                                                    <label class="form-check-label" for="critical_care">Critical Care Transport</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" name="services[]" value="neonatal" id="neonatal">
                                                    <label class="form-check-label" for="neonatal">Neonatal Transport</label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" name="services[]" value="bariatric" id="bariatric">
                                                    <label class="form-check-label" for="bariatric">Bariatric Transport</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" name="services[]" value="international" id="international">
                                                    <label class="form-check-label" for="international">International Repatriation</label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" name="services[]" value="organ_transport" id="organ_transport">
                                                    <label class="form-check-label" for="organ_transport">Organ Transport</label>
                                                </div>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" name="services[]" value="ground_coordination" id="ground_coordination">
                                                    <label class="form-check-label" for="ground_coordination">Ground Coordination</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="operating_hours" class="form-label">Operating Hours</label>
                                            <select class="form-control" id="operating_hours" name="operating_hours">
                                                <option value="24_7">24/7 Operations</option>
                                                <option value="extended">Extended Hours (6 AM - 10 PM)</option>
                                                <option value="business">Business Hours Only</option>
                                                <option value="on_call">On-Call Availability</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="fleet_size" class="form-label">Fleet Size</label>
                                            <input type="number" class="form-control" id="fleet_size" name="fleet_size" min="1">
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <button type="button" class="btn btn-secondary" onclick="goBack()">
                                            <i class="fas fa-arrow-left me-2"></i>Back to Selection
                                        </button>
                                        <button type="submit" class="btn btn-success btn-lg">
                                            Register as Affiliate <i class="fas fa-arrow-right ms-2"></i>
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Provider Registration Form -->
                    <div id="providerForm" class="registration-form" style="display: none;">
                        <div class="card shadow-sm">
                            <div class="card-header bg-success text-white">
                                <h4 class="mb-0"><i class="fas fa-hospital me-2"></i>Healthcare Provider Registration</h4>
                            </div>
                            <div class="card-body">
                                <form method="POST" action="{{ url_for('join_hospital') }}">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="facility_name" class="form-label">Facility Name *</label>
                                            <input type="text" class="form-control" id="facility_name" name="facility_name" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="facility_type" class="form-label">Facility Type</label>
                                            <select class="form-control" id="facility_type" name="facility_type">
                                                <option value="hospital">Hospital</option>
                                                <option value="clinic">Clinic</option>
                                                <option value="urgent_care">Urgent Care</option>
                                                <option value="rehab_facility">Rehabilitation Facility</option>
                                                <option value="nursing_home">Nursing Home</option>
                                                <option value="other">Other</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="first_name" class="form-label">Contact First Name *</label>
                                            <input type="text" class="form-control" id="first_name" name="first_name" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="last_name" class="form-label">Contact Last Name *</label>
                                            <input type="text" class="form-control" id="last_name" name="last_name" required>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="email" class="form-label">Professional Email *</label>
                                            <input type="email" class="form-control" id="email" name="email" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="phone" class="form-label">Direct Phone *</label>
                                            <input type="tel" class="form-control" id="phone" name="phone" required>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="cell_phone" class="form-label">24/7 Cell Phone</label>
                                            <input type="tel" class="form-control" id="cell_phone" name="cell_phone">
                                            <div class="form-check mt-2">
                                                <input class="form-check-input" type="checkbox" id="same_as_direct_phone" onchange="toggleSamePhoneProvider()">
                                                <label class="form-check-label" for="same_as_direct_phone">
                                                    Same as direct phone
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="department" class="form-label">Department/Role</label>
                                            <input type="text" class="form-control" id="department" name="department" placeholder="e.g., Emergency Department, Case Management">
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label for="address" class="form-label">Facility Address *</label>
                                        <textarea class="form-control" id="address" name="address" rows="2" required></textarea>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <button type="button" class="btn btn-secondary" onclick="goBack()">
                                            <i class="fas fa-arrow-left me-2"></i>Back to Selection
                                        </button>
                                        <button type="submit" class="btn btn-success btn-lg">
                                            Register as Provider <i class="fas fa-arrow-right ms-2"></i>
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Individual Registration Form -->
                    <div id="individualForm" class="registration-form" style="display: none;">
                        <div class="card shadow-sm">
                            <div class="card-header bg-warning text-dark">
                                <h4 class="mb-0"><i class="fas fa-users me-2"></i>Individual Registration</h4>
                            </div>
                            <div class="card-body">
                                <form method="POST" action="{{ url_for('join_individual') }}">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="first_name" class="form-label">First Name *</label>
                                            <input type="text" class="form-control" id="first_name" name="first_name" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="last_name" class="form-label">Last Name *</label>
                                            <input type="text" class="form-control" id="last_name" name="last_name" required>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="email" class="form-label">Email Address *</label>
                                            <input type="email" class="form-control" id="email" name="email" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="mobile_phone" class="form-label">Mobile Phone *</label>
                                            <input type="tel" class="form-control" id="mobile_phone" name="mobile_phone" required>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="password" class="form-label">Password *</label>
                                            <input type="password" class="form-control" id="password" name="password" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="relationship" class="form-label">Relationship to Patient</label>
                                            <select class="form-control" id="relationship" name="relationship">
                                                <option value="">Select...</option>
                                                <option value="self">Self</option>
                                                <option value="spouse">Spouse/Partner</option>
                                                <option value="parent">Parent</option>
                                                <option value="child">Child</option>
                                                <option value="sibling">Sibling</option>
                                                <option value="other_family">Other Family</option>
                                                <option value="friend">Friend</option>
                                                <option value="caregiver">Caregiver</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="marketing_opt_in" name="marketing_opt_in">
                                            <label class="form-check-label" for="marketing_opt_in">
                                                I would like to receive updates about transport services and health tips
                                            </label>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <button type="button" class="btn btn-secondary" onclick="goBack()">
                                            <i class="fas fa-arrow-left me-2"></i>Back to Selection
                                        </button>
                                        <button type="submit" class="btn btn-success btn-lg">
                                            Register as Individual <i class="fas fa-arrow-right ms-2"></i>
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Initial Continue Button (shown when no type selected) -->
                <div id="initialContinue" class="text-center">
                    <p class="text-muted mb-4">Select an account type above to continue</p>
                    <div class="text-center mt-3">
                        <p class="text-muted">
                            Already have an account? 
                            <a href="{{ url_for('auth.login') }}" class="text-decoration-none">Sign in here</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
let selectedType = '';

function selectUserType(type, element) {
    // Remove previous selection
    document.querySelectorAll('.user-type-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    // Add selection to clicked card
    element.classList.add('selected');
    
    // Store selected type
    selectedType = type;
    
    // Hide the user type selection cards and initial continue button
    document.querySelector('.row.g-4.mb-5').style.display = 'none';
    document.getElementById('initialContinue').style.display = 'none';
    
    // Show registration forms section
    document.getElementById('registrationForms').style.display = 'block';
    
    // Hide all forms first
    document.querySelectorAll('.registration-form').forEach(form => {
        form.style.display = 'none';
    });
    
    // Show the selected form
    if (type === 'affiliate') {
        document.getElementById('affiliateForm').style.display = 'block';
    } else if (type === 'provider') {
        document.getElementById('providerForm').style.display = 'block';
    } else if (type === 'individual') {
        document.getElementById('individualForm').style.display = 'block';
    }
}

function toggleSamePhone() {
    const businessPhone = document.getElementById('phone');
    const afterHoursPhone = document.getElementById('after_hours_phone');
    const checkbox = document.getElementById('same_as_business_phone');
    
    if (checkbox.checked) {
        afterHoursPhone.value = businessPhone.value;
        afterHoursPhone.readOnly = true;
    } else {
        afterHoursPhone.readOnly = false;
    }
}

function toggleSamePhoneProvider() {
    const directPhone = document.getElementById('phone');
    const cellPhone = document.getElementById('cell_phone');
    const checkbox = document.getElementById('same_as_direct_phone');
    
    if (checkbox.checked) {
        cellPhone.value = directPhone.value;
        cellPhone.readOnly = true;
    } else {
        cellPhone.readOnly = false;
    }
}

function goBack() {
    // Hide registration forms
    document.getElementById('registrationForms').style.display = 'none';
    
    // Show user type selection cards and initial continue button
    document.querySelector('.row.g-4.mb-5').style.display = '';
    document.getElementById('initialContinue').style.display = 'block';
    
    // Remove selection
    document.querySelectorAll('.user-type-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    selectedType = '';
}
</script>
{% endblock %}